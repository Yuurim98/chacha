<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
 <mapper namespace="research">
 
	<insert id="researchInsert" parameterType="kr.co.chacha.research.ResearchDTO">
	 	INSERT INTO research (rno, rtitle, rdate1, rdate2, rstate, rop, rgdate)
		VALUES (#{rno}, #{rtitle}, #{rdate1}, #{rdate2}, #{rstate}, #{rop}, NOW())
	</insert>	
		
	<insert id="researchqInsert" parameterType="java.util.List">
	    INSERT INTO researchq(rno, qcont, qtype, qty)
	    VALUES
	    <foreach collection="list" item="item" index="index" separator=",">
	        (#{item.rno}, #{item.qcont}, #{item.qtype}, #{item.qty})
	    </foreach>
	</insert> 
		
	<insert id="researchcInsert" parameterType="java.util.List">
	    INSERT INTO researchc(qno, choice)
	    VALUES
	    <foreach collection="list" item="item" index="index" separator=",">
	        (#{item.qno}, #{item.choice})
	    </foreach>
	</insert> 
	
	<select id="checkQno" parameterType="String" resultType="kr.co.chacha.research.ResearchDTO">
	  	SELECT qno
	  	FROM researchq
	  	WHERE rno = #{rno}
    </select>
    
    
    <select id="researchCheck" resultType="kr.co.chacha.research.ResearchDTO">
 		SELECT rno, rtitle, rdate1, rdate2, rstate, rop, rgdate
 		FROM research
 		ORDER BY rgdate desc
 	</select>
 	
 	<select id="researchCheck2" resultType="kr.co.chacha.research.ResearchDTO">
 		SELECT rno, rtitle, rdate1, rdate2, rstate, rop, rgdate
 		FROM research
 		WHERE rno = #{rno}
 	</select>
 	
 	
 	<select id="researchrList" resultType="kr.co.chacha.research.ResearchDTO">
		SELECT rq.rno, rq.qcont, rq.qtype, rc.cno, rc.qno, rc.choice, rq.qty
		FROM researchq rq
		JOIN researchc rc ON rq.qno = rc.qno
		WHERE rq.rno = #{rno}
 	</select>
    
    
    <insert id="researchrInsert" parameterType="kr.co.chacha.research.ResearchDTO">
	    INSERT INTO researchr(qno, uid, reply, rpdate)
	    VALUES(#{qno}, #{uid}, #{reply}, NOW())
	</insert> 
   	
    
    
    <!--qno = {166, 167, 168}  -->
    <!--reply = {135, 138, 140}  -->
    
    <insert id="researchrInsertmul" parameterType="java.util.List">
	    INSERT INTO researchr(qno, uid, reply, rpdate)
	    VALUES
	    <foreach collection="list" item="item" index="index" separator=",">
	        (#{item.qno}, #{item.uid}, #{item.reply}, NOW())
	    </foreach>
	</insert> 
    

    

 </mapper>
 

 
 
 
 
 
 
 
 
 
 
 
 
	
	
	