<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
 <mapper namespace="research">
 
	<insert id="researchInsert" parameterType="kr.co.chacha.research.ResearchDTO">
	 	INSERT INTO research (rno, rtitle, rdate1, rdate2, rstate, rop, rgdate)
		VALUES (#{rno}, #{rtitle}, #{rdate1}, #{rdate2}, #{rstate}, #{rop}, NOW())
	</insert>	
	
	<insert id="researchqInsert" parameterType="java.util.List">
	    INSERT INTO researchq(rno, qcont, qtype)
	    VALUES
	    <foreach collection="list" item="item" index="index" separator=",">
	        (#{item.rno}, #{item.qcont}, #{item.qtype})
	    </foreach>
	</insert>

	<select id="checkQno" parameterType="kr.co.chacha.research.ResearchDTO" resultType="Int">
	  	SELECT qno
	  	FROM researchq
	  	WHERE rno = #{rno}
    </select>
    
    
    <select id="researchCheck" resultType="kr.co.chacha.research.ResearchDTO">
 		SELECT rno, rtitle, rdate1, rdate2, rstate, rop, rgdate
 		FROM research
 		ORDER BY rgdate desc
 	</select>
 	
 	<select id="researchCheck2" resultType="kr.co.chacha.research.ResearchDTO">
 		SELECT rno, rtitle, rdate1, rdate2, rstate, rop, rgdate
 		FROM research
 		WHERE rno = #{rno}
 	</select>
 	
 	<select id="researchForm" resultType="kr.co.chacha.research.ResearchDTO"> 		
		SELECT rq.qcont
		FROM researchq rq JOIN researchc rc 
		ON rq.qno = rc.qno
		WHERE rq.rno = #{rno} AND rc.cno = 14
 	</select>
    
    <select id="researchChoice" resultType="kr.co.chacha.research.ResearchDTO"> 		
		SELECT rc.qno, rc.choice
		FROM researchq rq
		JOIN researchc rc ON rq.qno = rc.qno
		WHERE rq.rno = #{rno} AND rq.qno = 17
 	</select>
    
    

 </mapper>
 

 
	
	
	